<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="pageTitle">Studio Architettura & Design</title>
    <!-- Favicon per la barra del browser -->
    <link rel="icon" href="https://adpe-web-galleries.s3.eu-north-1.amazonaws.com/static/adpelogo.jpg" type="image/jpeg">
    <!-- Google Font: Roboto Mono -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Variabili CSS per il tema chiaro */
        :root {
            --primary-color: #ffffff;
            --secondary-color: #f8f9fa;
            --text-color: rgb(8, 43, 46);
            --autumn-blue: #4a90e2; /* Colore dal logo: blu */
            --autumn-blue: #2da6c4; /* Colore autunnale: blu */
            --accent-orange: #d4693a; /* Colore dal logo: arancio */
            --accent-brown: #8b4513; /* Colore dal logo: marrone */
            --accent-green: #7fb069; /* Colore dal logo: verde */
            --accent-gold: #efb34b;
            --border-color: rgb(45, 166, 196);
            --shadow-light: 0 4px 20px rgba(0,0,0,0.05);
            --shadow-medium: 0 8px 30px rgba(0,0,0,0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Variabili CSS per il tema scuro */
        body.dark-theme {
            --primary-color: #1a1a1a;
            --secondary-color: #2c2c2c;
            --text-color: #f0f0f0;
            --border-color: #444;
            --shadow-light: 0 4px 20px rgba(0,0,0,0.3);
            --shadow-medium: 0 8px 30px rgba(0,0,0,0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto Mono', monospace;
            background: var(--primary-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            padding-top: 80px;
            padding-bottom: 60px;
            transition: background var(--transition), color var(--transition);
        }

        /* Background Geometric Elements */
        body::before, body::after, .geometric-square-background, .background-rectangle {
            content: '';
            position: fixed;
            z-index: -1;
            pointer-events: none;
            transition: opacity var(--transition);
        }
        body::before { top: 5%; left: 5%; width: 400px; height: 400px; background-color: var(--accent-brown); border-radius: 50%; opacity: 0.2; animation: floatCircle 85s ease-in-out infinite; }
        body::after { top: 40%; right: 10%; width: 300px; height: 400px; background-color: var(--autumn-blue); clip-path: polygon(50% 0%, 0% 100%, 100% 100%); opacity: 0.2; animation: floatTriangle 250s ease-in-out infinite; }
        .geometric-square-background { top: 10%; left: 80%; width: 305px; height: 305px; background: var(--accent-green); opacity: 0.19; animation: floatGeometry 250s ease-in-out infinite reverse; border-radius: 2%; }
        .background-rectangle { bottom: 10%; left: 25%; width: 305px; height: 305px; background: var(--accent-gold); opacity: 0.19; animation: floatRectangle 250s ease-in-out infinite reverse; border-radius: 2%; }

        body.dark-theme::before, body.dark-theme::after, body.dark-theme .geometric-square-background, body.dark-theme .background-rectangle {
            opacity: 0.1;
        }

        /* Keyframes per le animazioni */
        @keyframes floatTriangle { 0%, 100% { transform: rotate(0deg) translateY(0px); } 33% { transform: rotate(120deg) translateY(-20px); } 66% { transform: rotate(240deg) translateY(10px); } }
        @keyframes floatCircle { 0%, 100% { transform: translate(0px, 0px) scale(1); } 40% { transform: translate(-30px, 50px) scale(1.02); } 70% { transform: translate(20px, -40px) scale(0.98); } }
        @keyframes floatGeometry { 0%, 100% { transform: rotate(0deg) translateX(20px); } 33% { transform: rotate(120deg) translateY(-20px); } 66% { transform: rotate(240deg) translateY(10px); } }
        @keyframes floatRectangle { 0%, 100% { transform: rotate(0deg) translateX(-100px); } 33% { transform: rotate(120deg) translateY(-20px); } 66% { transform: rotate(240deg) translateY(10px); } }

        /* Media queries per le forme geometriche */
        @media (max-width: 768px) {
            body::before { width: 200px; height: 200px; top: 8%; left: 8%; } /* Increased size */
            body::after { width: 160px; height: 200px; top: 45%; right: 7%; } /* Increased size */
            .geometric-square-background { width: 160px; height: 160px; top: 12%; left: 75%; } /* Increased size */
            .background-rectangle { width: 160px; height: 160px; bottom: 12%; left: 22%; } /* Increased size */
        }

        @media (max-width: 480px) {
            body::before { width: 120px; height: 120px; top: 12%; left: 7%; } /* Increased size */
            body::after { width: 90px; height: 120px; top: 55%; right: 4%; } /* Increased size */
            .geometric-square-background { width: 90px; height: 90px; top: 18%; left: 78%; } /* Increased size */
            .background-rectangle { width: 90px; height: 90px; bottom: 18%; left: 15%; } /* Increased size */
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: transparent;
            padding: 1rem 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: none;
            box-shadow: none;
            backdrop-filter: none;
            transition: background 0.3s ease;
        }

        header.scrolled {
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), transparent);
        }

        body.dark-theme header.scrolled {
            background: linear-gradient(to bottom, rgba(26, 26, 26, 0.9), transparent);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left { display: flex; align-items: center; gap: 10px; }
        .header-logo-small { height: 35px; width: 35px; border-radius: 50%; object-fit: cover; transition: var(--transition); }
        .header-logo-small:hover { transform: scale(1.1); }
        .logo { font-size: 1.6rem; font-weight: 300; color: var(--text-color); text-decoration: none; letter-spacing: 2px; transition: var(--transition); }
        .logo:hover { transform: scale(1.05); }

        .nav-menu { display: flex; gap: 6rem; list-style: none; flex-grow: 1; justify-content: center; }
        .nav-link { color: var(--text-color); text-decoration: none; font-weight: 400; font-size: 1.5rem; transition: var(--transition); position: relative; cursor: pointer; letter-spacing: 1px; }
        .nav-link:hover { color: var(--autumn-blue); transform: translateY(-2px) scale(1.02); }
        .nav-link::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px; background: var(--autumn-blue); transition: var(--transition); }
        .nav-link:hover::after { width: 100%; }

        .hamburger { display: none; flex-direction: column; cursor: pointer; transition: var(--transition); }
        .hamburger span { width: 25px; height: 2px; background: var(--text-color); margin: 3px 0; transition: var(--transition); }

        .header-right-icons { display: flex; align-items: center; gap: 1.5rem; }
        .language-group, .theme-group { display: flex; align-items: center; }
        .language-group { gap: 0.8rem; margin-right: 0.5rem; }

        .header-social-link, .language-selector-item { color: var(--text-color); font-size: 1.3rem; transition: var(--transition); text-decoration: none; cursor: pointer; }
        .header-social-link:hover, .language-selector-item:hover { color: var(--autumn-blue); transform: scale(1.2); }
        #themeToggle i { font-size: 1.4rem; color: var(--text-color); transition: color var(--transition); }
        body.dark-theme #themeToggle i { color: var(--accent-gold); }
        .language-selector-item { font-size: 1.0rem; font-weight: bold; text-transform: uppercase; }
        .language-selector-item.active { color: var(--autumn-blue); text-decoration: underline; }

        /* Hero Section */
        .hero { min-height: calc(50vh - 80px); display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; position: relative; overflow: hidden; padding-top: 4rem; padding-bottom: 2rem; scroll-margin-top: 85px; }
        .hero-content { position: relative; z-index: 1; animation: fadeInUp 0.6s ease-out; }
        .hero h1 { font-size: 6rem; font-weight: 300; margin-bottom: 2rem; letter-spacing: 8px; color: var(--text-color); }
        .studio-logo { width: 132px; height: 132px; background: rgba(255, 255, 255, 0.9); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 4rem; margin: 8rem auto; box-shadow: var(--shadow-medium); border: 0px solid var(--autumn-blue); animation: logoFloat 6s ease-in-out infinite; overflow: hidden; transition: background var(--transition), border-color var(--transition), box-shadow var(--transition); }
        body.dark-theme .studio-logo { background: rgba(44, 44, 44, 0.9); border: 0px solid var(--accent-gold); box-shadow: var(--shadow-medium); }
        .studio-logo img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        @keyframes logoFloat { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }

        /* Media queries per il logo dello studio */
        @media (max-width: 768px) {
            .studio-logo {
                width: 110px; /* Increased size */
                height: 110px; /* Increased size */
                margin: 5rem auto; /* Adjusted margin */
            }
        }

        @media (max-width: 480px) {
            .studio-logo {
                width: 90px; /* Increased size */
                height: 90px; /* Increased size */
                margin: 4rem auto; /* Adjusted margin */
            }
        }

        /* Home Projects Section */
        .home-projects { padding: 4rem 0; background: linear-gradient(180deg, rgba(248, 249, 250, 0.3) 0%, rgba(255, 255, 255, 0.1) 100%); transition: background var(--transition); scroll-margin-top: 85px; }
        body.dark-theme .home-projects { background: linear-gradient(180deg, rgba(44, 44, 44, 0.3) 0%, rgba(26, 26, 26, 0.1) 100%); }
        .home-projects h2 { text-align: center; font-size: 3rem; font-weight: 200; margin-bottom: 3rem; color: var(--text-color); letter-spacing: 2px; }
        
        /* ✅ NUOVA GRIGLIA PER LA HOME */
        .home-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 6.0rem;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ✅ MANTENUTA LA GRIGLIA MASONRY PER PROGETTI */
        .projects-grid {
            column-count: 3;
            column-gap: 6.0rem;
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .container,
        .home-grid,
        .projects-grid {
            max-width: 92vw;     /* Occupa il 95% della larghezza viewport */
            margin: 0 auto;      /* Mantiene centrato */
            padding: 0 10px;     /* Riduce il padding laterale */
        }

        @media (max-width: 1024px) {
            .projects-grid { column-count: 2; }
        }
        @media (max-width: 768px) {
            .projects-grid { column-count: 1; }
        }

        /* Card per il layout Masonry */
        .project-card {
            background: var(--secondary-color);
            border-radius: 0px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
            cursor: pointer;
            margin-bottom: 6.0rem; /* Spazio tra le card nella stessa colonna */
            display: inline-block; /* Necessario per il layout a colonne */
            width: 100%;
            animation: fadeInUp 0.6s ease-out forwards;
        }

        body.dark-theme .project-card {
            background: rgba(44, 44, 44, 0.9);
            box-shadow: var(--shadow-light);
        }

        .project-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-medium);
        }
        
        .project-card img {
            width: 100%;
            height: auto; /* Mantiene le proporzioni originali */
            display: block;
            transition: transform 0.3s ease;
        }
        
        .project-card:hover img {
            transform: scale(1.05);
        }

        /* Stili per i bottoni del filtro */
        .filter-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 0.8rem 1.5rem;
            margin: 0.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 1.1rem;
        }

        .filter-btn:hover {
            background: var(--autumn-blue);
            color: var(--primary-color);
            border-color: var(--autumn-blue);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: var(--autumn-blue);
            color: var(--primary-color);
            border-color: var(--autumn-blue);
            font-weight: bold;
        }

        .projects-section .section-title {
            text-align: center;
            font-size: 3rem;
            font-weight: 200;
            margin-bottom: 2rem;
            color: var(--text-color);
            letter-spacing: 1px;
            animation: fadeInUp 0.6s ease-out forwards;
        }

        /* Project Detail Page */
        .project-detail { padding: 4rem 0; min-height: calc(100vh - 80px); display: flex; flex-direction: column; align-items: center; text-align: center; }
        .project-detail-title { font-size: 3.5rem; font-weight: 200; margin-bottom: 1rem; color: var(--text-color); letter-spacing: 1px; }
        .project-detail-category { color: var(--autumn-blue); font-size: 1.1rem; font-weight: 500; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 2rem; }
        .project-detail-description { max-width: 800px; margin: 0 auto 3rem; font-size: 1.2rem; line-height: 1.8; text-align: center; opacity: 0.9; }
        .project-gallery { display: flex; flex-direction: column; max-width: 1200px; margin: 0 auto; width: 100%; padding: 0 20px; }
        .gallery-item { background: transparent; border-radius: 12px; overflow: hidden; box-shadow: none; transition: var(--transition); height: auto; min-height: 75vh; display: flex; align-items: center; padding: 1rem; margin-bottom: 2.5rem; }
        .gallery-item:last-child { margin-bottom: 0; }
        .gallery-item:hover { transform: translateY(-5px) scale(1.01); }
        .gallery-item:nth-child(odd) { flex-direction: row; margin-right: auto; text-align: left; }
        .gallery-item:nth-child(even) { flex-direction: row-reverse; margin-left: auto; text-align: right; }
        .gallery-item img { max-height: 70vh; width: auto; max-width: 55%; height: auto; object-fit: contain; display: block; flex-shrink: 0; padding: 0.5rem; border-radius: 8px; box-shadow: var(--shadow-light); cursor: pointer; }
        .gallery-description { flex-grow: 1; padding: 1rem 2rem; margin: 0; max-width: 45%; line-height: 1.7; font-size: 1.15rem; text-align: inherit; color: var(--text-color); opacity: 0.9; font-style: normal; }

        /* Sezioni "Chi Siamo" e "Contatti" */
        .projects-section, .about-section, .contact-section { padding: 4rem 0; min-height: calc(100vh - 80px); display: flex; flex-direction: column; align-items: center; text-align: center; scroll-margin-top: 85px; }
        .about-content, .contact-content { max-width: 1000px; margin: 0 auto; padding: 0 20px; }
        .about-title, .contact-title { font-size: 3.5rem; font-weight: 200; margin-bottom: 2rem; color: var(--text-color); letter-spacing: 1px; animation: fadeInUp 0.6s ease-out forwards; }
        .about-text { font-size: 1.3rem; line-height: 1.8; margin-bottom: 3rem; opacity: 0.9; }
        .about-image { max-width: 40%; height: auto; border-radius: 12px; box-shadow: var(--shadow-medium); margin: 2rem auto 3rem auto; display: block; }
        .about-highlights { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin-top: 3rem; }
        .highlight-card { background: rgba(255, 255, 255, 0.8); padding: 2.5rem; border-radius: 12px; box-shadow: var(--shadow-light); transition: var(--transition); text-align: center; }
        body.dark-theme .highlight-card { background: rgba(44, 44, 44, 0.8); }
        .highlight-card:hover { transform: translateY(-5px) scale(1.02); box-shadow: var(--shadow-medium); }
        .highlight-icon { font-size: 3.5rem; margin-bottom: 1.5rem; display: block; color: var(--accent-orange); }
        .highlight-title { font-size: 1.6rem; font-weight: 500; margin-bottom: 1rem; color: var(--text-color); letter-spacing: 0.5px; }
        .highlight-description { font-size: 1.05rem; color: var(--text-color); opacity: 0.8; }
        .contact-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 3rem; }
        .contact-card { background: rgba(255, 255, 255, 0.8); padding: 2.5rem; border-radius: 12px; box-shadow: var(--shadow-light); transition: var(--transition); text-align: center; }
        body.dark-theme .contact-card { background: rgba(44, 44, 44, 0.8); }
        .contact-card:hover { transform: translateY(-5px) scale(1.02); box-shadow: var(--shadow-medium); }
        .contact-icon { font-size: 3rem; margin-bottom: 1.5rem; color: var(--autumn-blue); }
        .contact-label { font-weight: 500; margin-bottom: 0.8rem; color: var(--text-color); font-size: 1.3rem; letter-spacing: 0.5px; }
        .contact-value { opacity: 0.9; line-height: 1.6; font-size: 1.1rem; word-wrap: break-word; }
        .contact-value a { color: var(--text-color); text-decoration: none; transition: var(--transition); }
        .contact-value a:hover { color: var(--autumn-blue); text-decoration: underline; }
        .map-widget { position: relative; width: 100%; height: 200px; border-radius: 8px; overflow: hidden; margin-top: 1rem; margin-bottom: 1rem; }
        .map-widget iframe { width: 100%; height: 100%; display: block; }
        .map-overlay-link { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); display: flex; align-items: center; justify-content: center; text-decoration: none; color: white; font-size: 1.1rem; font-weight: bold; opacity: 0; transition: opacity 0.3s ease; z-index: 10; border-radius: 8px; cursor: pointer; }
        .map-widget:hover .map-overlay-link { opacity: 1; }
        .map-text-overlay { padding: 10px 20px; background: rgba(0, 0, 0, 0.7); border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }

        /* Modal per immagine a schermo intero */
        .image-modal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; overflow: hidden; background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px); align-items: center; justify-content: center; animation: fadeIn 0.3s ease-out; }
        .image-modal-content { margin: auto; display: block; max-width: 90vw; max-height: 90vh; object-fit: contain; border-radius: 8px; box-shadow: var(--shadow-medium); transition: transform 0.3s ease; }
        .image-modal-content:hover { transform: scale(1.01); }
        .modal-close { position: absolute; top: 20px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; transition: 0.3s; cursor: pointer; z-index: 10000; }
        .modal-close:hover, .modal-close:focus { color: var(--autumn-blue); text-decoration: none; cursor: pointer; }
        .modal-prev, .modal-next { cursor: pointer; position: absolute; top: 50%; width: auto; padding: 16px; margin-top: -50px; color: white; font-weight: bold; font-size: 20px; transition: 0.6s ease; border-radius: 0 3px 3px 0; user-select: none; -webkit-user-select: none; background-color: rgba(0,0,0,0.5); z-index: 10000; }
        .modal-next { right: 0; border-radius: 3px 0 0 3px; }
        .modal-prev { left: 0; }
        .modal-prev:hover, .modal-next:hover { background-color: rgba(0,0,0,0.8); }

        /* Footer Styles */
        footer { background: transparent; padding: 1rem 0; position: fixed; bottom: 0; width: 100%; z-index: 999; border-top: none; box-shadow: none; backdrop-filter: none; transition: background 0.3s ease; display: flex; justify-content: center; align-items: center; }
        footer.scrolled { background: linear-gradient(to top, rgba(255, 255, 255, 0.9), transparent); }
        body.dark-theme footer { background: transparent; border-top: none; backdrop-filter: none; }
        body.dark-theme footer.scrolled { background: linear-gradient(to top, rgba(26, 26, 26, 0.9), transparent); }
        .footer-social-group { display: flex; gap: 1.5rem; padding: 0 20px; }
        .footer-social-link { color: var(--text-color); font-size: 1.5rem; transition: var(--transition); text-decoration: none; cursor: pointer; }
        .footer-social-link:hover { color: var(--autumn-blue); transform: scale(1.2); }

        /* Animazioni */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeInUp 0.6s ease-out forwards; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu { position: fixed; top: 80px; left: -100%; width: 100%; height: calc(100vh - 80px); background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(20px); flex-direction: column; justify-content: flex-start; align-items: center; padding-top: 3rem; transition: var(--transition); }
            body.dark-theme .nav-menu { background: rgba(26, 26, 26, 0.98); }
            .nav-menu.active { left: 0; }
            .hamburger { display: flex; }
            .hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
            .hamburger.active span:nth-child(2) { opacity: 0; }
            .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(7px, -6px); }
            .hero h1 { font-size: 3rem; }
            .nav-link { font-size: 1.1rem; }
            .project-description { font-size: 1rem; }
            .about-highlights, .contact-info { grid-template-columns: 1fr; gap: 1.5rem; }
            .project-detail-title { font-size: 2.5rem; }
            .project-detail-description { font-size: 1.1rem; }
            .header-right-icons { flex-wrap: wrap; justify-content: flex-end; gap: 1rem; }
            .gallery-item { flex-direction: column !important; margin-left: auto !important; margin-right: auto !important; text-align: center !important; min-height: auto; padding: 0.5rem; margin-bottom: 2rem; }
            .gallery-item img { max-width: 90%; max-height: 50vh; margin-bottom: 1rem; padding: 0; }
            .gallery-description { max-width: 90%; padding: 0.5rem 1rem; font-size: 1.05rem; }
            .modal-close { font-size: 30px; top: 15px; right: 20px; }
            .modal-prev, .modal-next { padding: 10px; font-size: 16px; margin-top: -30px; }
            .home-projects h2, .projects-section .section-title, .about-title, .contact-title { font-size: 2.5rem; }
            .highlight-title { font-size: 1.4rem; }
            .highlight-description { font-size: 1rem; }
            .contact-label { font-size: 1.1rem; }
            .contact-value { font-size: 1.05rem; }
            .footer-social-group { gap: 1rem; }
        }

        @media (max-width: 480px) {
            .container { padding: 0 15px; }
            .hero h1 { font-size: 2.5rem; }
            .projects-grid { padding: 0 1rem; }
            .project-detail-title { font-size: 2rem; }
            .about-title, .contact-title { font-size: 2rem; }
        }

        /* Stili per il pulsante "Torna ai Progetti" */
        .back-to-projects-btn {
            background: var(--autumn-blue);
            color: var(--primary-color);
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            font-size: 1.1rem;
            transition: var(--transition);
            margin-bottom: 2rem;
        }

        .back-to-projects-btn:hover {
            background: var(--text-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .project-card {
            position: relative;
            overflow: hidden;
        }

        .project-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 0.8rem;
            text-align: center;
            font-size: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .project-card:hover .project-overlay {
            opacity: 1;
        }
        
        /* Nuovo stile per allineare il pulsante "Torna ai Progetti" */
        .project-detail .back-to-projects-btn {
            margin-top: 6rem; /* Aggiunge un margine superiore per allinearlo visivamente */
        }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="geometric-square-background"></div>
    <div class="background-rectangle"></div>
    <header>
        <nav class="container">
            <div class="header-left">
                <img src="https://adpe-web-galleries.s3.eu-north-1.amazonaws.com/static/adpelogo.jpg" alt="ADPE Logo" class="header-logo-small">
                <a href="#" class="logo" onclick="showHome()">ADPE</a>
            </div>
            <ul class="nav-menu">
                <li><a href="#" class="nav-link" data-lang-key="homeLink" onclick="showHome()">Home</a></li>
                <li><a href="#" class="nav-link" data-lang-key="projectsLink" onclick="showProjectsSection()">Progetti</a></li>
                <li><a href="#" class="nav-link" data-lang-key="aboutLink" onclick="showAbout()">Chi Siamo</a></li>
                <li><a href="#" class="nav-link" data-lang-key="contactLink" onclick="showContact()">Contatti</a></li>
            </ul>
            <div class="header-right-icons">
                <div class="language-group">
                    <a href="#" class="language-selector-item active" data-lang="it">IT</a>
                    <a href="#" class="language-selector-item" data-lang="en">EN</a>
                    <a href="#" class="language-selector-item" data-lang="fr">FR</a>
                </div>
                <div class="theme-group">
                    <a href="#" class="header-social-link" id="themeToggle" aria-label="Toggle dark/light theme">
                        <i class="fas fa-lightbulb"></i>
                    </a>
                </div>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main>
        <section class="hero" id="hero">
            <div class="hero-content">
                <div class="studio-logo">
                    <img src="https://adpe-web-galleries.s3.eu-north-1.amazonaws.com/static/adpelogo.jpg" alt="Studio Logo">
                </div>
            </div>
        </section>

        <section class="home-projects" id="homeProjects">
            <div class="container">
                <div class="projects-grid" id="homeProjectsGrid">
                    <!-- Progetti generati dinamicamente -->
                </div>
            </div>
        </section>

        <section class="container projects-section" id="projectsSection" style="display: none;">
            <div class="project-filters" id="projectFilters" style="text-align: center; margin-bottom: 2.5rem;">
                <!-- I bottoni del filtro saranno generati da JS -->
            </div>
            
            <div class="projects-grid" id="projectsGrid">
                <!-- Progetti generati dinamicamente da JavaScript -->
            </div>

            <div class="project-detail" id="singleProjectDetail" style="display: none;">
                <!-- Dettaglio singolo progetto generato dinamicamente -->
            </div>
        </section>

        <section class="about-section" id="aboutSection" style="display: none;">
            <div class="container about-content">
                <h2 class="about-title" data-lang-key="aboutTitle">Chi Siamo</h2>
                <img src="https://adpe-web-galleries.s3.eu-north-1.amazonaws.com/static/studioadpe.jpg" alt="Immagine dello Studio" class="about-image">
                <p class="about-text" data-lang-key="aboutText">
                    Lo Studio ADPE, fondato dall'architetto Adriano Pernazza, è una realtà dinamica e innovativa nel panorama dell'architettura e del design. Da anni, ci dedichiamo alla progettazione di spazi che combinano estetica, funzionalità e sostenibilità. La nostra filosofia si basa sull'ascolto attento delle esigenze del cliente, trasformando le idee in realtà tangibili e uniche.
                </p>
                <div class="about-highlights">
                    <div class="highlight-card">
                        <i class="fas fa-lightbulb highlight-icon"></i>
                        <h3 class="highlight-title" data-lang-key="creativityTitle">Creatività e Innovazione</h3>
                        <p class="highlight-description" data-lang-key="creativityDesc">Approccio originale e soluzioni all'avanguardia per ogni progetto.</p>
                    </div>
                    <div class="highlight-card">
                        <i class="fas fa-handshake highlight-icon"></i>
                        <h3 class="highlight-title" data-lang-key="collaborationTitle">Collaborazione Clienti</h3>
                        <p class="highlight-description" data-lang-key="collaborationDesc">Un processo di progettazione partecipato e trasparente.</p>
                    </div>
                    <div class="highlight-card">
                        <i class="fas fa-seedling highlight-icon"></i>
                        <h3 class="highlight-title" data-lang-key="sustainabilityTitle">Sostenibilità</h3>
                        <p class="highlight-description" data-lang-key="sustainabilityDesc">Progettazione attenta all'ambiente e all'efficienza energetica.</p>
                    </div>
                    <div class="highlight-card">
                        <i class="fas fa-award highlight-icon"></i>
                        <h3 class="highlight-title" data-lang-key="qualityTitle">Qualità e Dettaglio</h3>
                        <p class="highlight-description" data-lang-key="qualityDesc">Cura maniacale per ogni aspetto, dal concept alla realizzazione.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="contact-section" id="contactSection" style="display: none;">
            <div class="container contact-content">
                <h2 class="contact-title" data-lang-key="contactTitle">Contatti</h2>
                <p class="contact-text" data-lang-key="contactText">
                    Siamo a vostra disposizione per qualsiasi informazione o per discutere del vostro prossimo progetto. Non esitate a contattarci.
                </p>
                <div class="contact-info">
                    <div class="contact-card">
                        <i class="fas fa-map-marker-alt contact-icon"></i>
                        <h3 class="contact-label" data-lang-key="addressLabel">Indirizzo</h3>
                        <div class="map-widget">
                            <iframe
                                src="https://maps.google.com/maps?q=Via%20di%20Monte%20Savello%2029A,%2000186%20Roma%20(RM),%20Italia&t=&z=15&ie=UTF8&iwloc=&output=embed"
                                width="100%"
                                height="200"
                                style="border:0; border-radius: 8px;"
                                allowfullscreen=""
                                loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade">
                            </iframe>
                            <a href="https://www.google.com/maps/dir/?api=1&destination=Via%20di%20Monte%20Savello%2029A,%2000186%20Roma%20(RM),%20Italia"
                               target="_blank" class="map-overlay-link" aria-label="Ottieni indicazioni su Google Maps">
                               <span class="map-text-overlay" data-lang-key="mapDirections">Clicca per indicazioni</span>
                            </a>
                        </div>
                        <p class="contact-value">Via di Monte Savello 29A, 00186 Roma (RM), Italia</p>
                    </div>
                    <div class="contact-card">
                        <i class="fas fa-phone contact-icon"></i>
                        <h3 class="contact-label" data-lang-key="phoneLabel">Telefono</h3>
                        <p class="contact-value"><a href="tel:+390612345678">+39 3285725667</a></p>
                    </div>
                    <div class="contact-card">
                        <i class="fas fa-envelope contact-icon"></i>
                        <h3 class="contact-label" data-lang-key="emailLabel">Email</h3>
                        <p class="contact-value"><a href="mailto:info@adpe.it">info@adpe.it</a></p>
                        <p class="contact-value"><a href="mailto:adpe.progetti@gmail.com">adpe.progetti@gmail.com</a></p>
                    </div>
                    <div class="contact-card">
                        <i class="fas fa-clock contact-icon"></i>
                        <h3 class="contact-label" data-lang-key="hoursLabel">Orari</h3>
                        <p class="contact-value" data-lang-key="hoursValue">Lun-Ven: 9:00 - 18:00</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Modal per visualizzazione immagine a schermo intero -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal(event)">
        <span class="modal-close" onclick="closeImageModal(event)">&times;</span>
        <span class="modal-prev" onclick="showPrevImage(event)">&lt;</span>
        <span class="modal-next" onclick="showNextImage(event)">&gt;</span>
        <img class="image-modal-content" id="modalImage">
    </div>

    <footer>
        <div class="footer-social-group">
            <a href="https://www.instagram.com/adpe_studiodiarchitettura/" target="_blank" class="footer-social-link" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            <a href="https://www.facebook.com/AdpeStudioDiArchitettura" target="_blank" class="footer-social-link" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="https://www.linkedin.com/company/adpe-studio/" target="_blank" class="footer-social-link" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
    </footer>

    <script>
        // Struttura dati per i progetti
        let projects = {};

        // Variabili globali
        let currentProjectImages = [];
        let currentImageIndex = 0;
        let lastActiveFilter = 'all'; 
        let currentView = 'home';
        let allProjectsFlattened = [];
        let currentLang = localStorage.getItem('lang') || 'it';

        // Oggetto per le traduzioni
        const translations = {
            it: {
                pageTitle: "ADPE Architettura e Design", homeLink: "Home", projectsLink: "Progetti", aboutLink: "Chi Siamo", contactLink: "Contatti",
                heroTitle: "ADPE", heroSubtitle: "Architettura e Design by Adriano Pernazza", portfolioTitle: "Progetti",
                category_architettura: "Architettura", category_design: "Design", category_residenziale: "Residenziale", category_pubblica: "Pubblica",
                unknownCategory: "Categoria Sconosciuta", aboutTitle: "Chi Siamo",
                aboutText: "Lo Studio ADPE, fondato dall'architetto Adriano Pernazza, è una realtà dinamica e innovativa nel panorama dell'architettura e del design. Da anni, ci dedichiamo alla progettazione di spazi che combinano estetica, funzionalità e sostenibilità. La nostra filosofia si basa sull'ascolto attento delle esigenze del cliente, trasformando le idee in realtà tangibili e uniche.",
                creativityTitle: "Creatività e Innovazione", creativityDesc: "Approccio originale e soluzioni all'avanguardia per ogni progetto.",
                collaborationTitle: "Collaborazione Clienti", collaborationDesc: "Un processo di progettazione partecipato e trasparente.",
                sustainabilityTitle: "Sostenibilità", sustainabilityDesc: "Progettazione attenta all'ambiente e all'efficienza energetica.",
                qualityTitle: "Qualità e Dettaglio", qualityDesc: "Cura maniacale per ogni aspetto, dal concept alla realizzazione.",
                contactTitle: "Contatti", contactText: "Siamo a vostra disposizione per qualsiasi informazione o per discutere del vostro prossimo progetto. Non esitate a contattarci.",
                addressLabel: "Indirizzo", mapDirections: "Clicca per indicazioni", phoneLabel: "Telefono", emailLabel: "Email", hoursLabel: "Orari", hoursValue: "Lun-Ven: 9:00 - 18:00",
                filterAll: "Tutti", backToProjects: "← Torna ai Progetti"
            },
            en: {
                pageTitle: "Architecture & Design Studio", homeLink: "Home", projectsLink: "Projects", aboutLink: "About Us", contactLink: "Contact",
                heroTitle: "ADPE", heroSubtitle: "Architecture and Design by Adriano Pernazza", portfolioTitle: "Projects",
                category_architettura: "Architecture", category_design: "Design", category_residenziale: "Residential", category_pubblica: "Public",
                unknownCategory: "Unknown Category", aboutTitle: "About Us",
                aboutText: "ADPE Studio, founded by architect Adriano Pernazza, is a dynamic and innovative reality in the field of architecture and design. For years, we have been dedicated to designing spaces that combine aesthetics, functionality, and sustainability. Our philosophy is based on carefully listening to client needs, transforming ideas into tangible and unique realities.",
                creativityTitle: "Creativity & Innovation", creativityDesc: "Original approach and cutting-edge solutions for every project.",
                collaborationTitle: "Client Collaboration", collaborationDesc: "A participatory and transparent design process.",
                sustainabilityTitle: "Sustainability", sustainabilityDesc: "Environmentally conscious and energy-efficient design.",
                qualityTitle: "Quality & Detail", qualityDesc: "Meticulous attention to every aspect, from concept to realization.",
                contactTitle: "Contact", contactText: "We are at your disposal for any information or to discuss your next project. Do not hesitate to contact us.",
                addressLabel: "Address", mapDirections: "Click for directions", phoneLabel: "Phone", emailLabel: "Email", hoursLabel: "Hours", hoursValue: "Mon-Fri: 9:00 AM - 6:00 PM",
                filterAll: "All", backToProjects: "← Back to Projects"
            },
            fr: {
                pageTitle: "Studio Architecture & Design", homeLink: "Accueil", projectsLink: "Projets", aboutLink: "À Propos", contactLink: "Contact",
                heroTitle: "ADPE", heroSubtitle: "Architecture et Design par Adriano Pernazza", portfolioTitle: "Projets",
                category_architettura: "Architecture", category_design: "Design", category_residenziale: "Résidentiel", category_pubblica: "Publique",
                unknownCategory: "Catégorie Inconnue", aboutTitle: "À Propos de Nous",
                aboutText: "Le Studio ADPE, fondé par l'architecte Adriano Pernazza, est une réalité dynamique et innovante dans le domaine de l'architecture et du design. Depuis des années, nous nous consacrons à la conception d'espace qui allient esthétique, fonctionnalité et durabilité. Notre philosophie repose sur une écoute attentive des besoins du client, transformant les idées en réalités tangibles et uniques.",
                creativityTitle: "Créatività et Innovation", creativityDesc: "Approche originale et solutions de pointe pour chaque projet.",
                collaborationTitle: "Collaborazione Client", collaborationDesc: "Un processo de conception participatif et transparent.",
                sustainabilityTitle: "Durabilité", sustainabilityDesc: "Conception soucieuse de l'environnement et de l'efficience énergétique.",
                qualityTitle: "Qualità et Détail", qualityDesc: "Attention méticuleuse à chaque aspect, du concept à la réalisation.",
                contactTitle: "Contact", contactText: "Nous siamo a votre disposition pour qualsiasi information ou pour discuter de votre prossimo progetto. N'hésitez pas à nous contacter.",
                addressLabel: "Adresse", mapDirections: "Cliquer pour les directions", phoneLabel: "Téléphone", emailLabel: "Email", hoursLabel: "Horaires", hoursValue: "Lun-Ven: 9h00 - 18h00",
                filterAll: "Tous", backToProjects: "← Retour aux Projets"
            }
        };
        
        // Inizializzazione al caricamento del DOM
        document.addEventListener('DOMContentLoaded', function() {
            // Carica i progetti e avvia l'applicazione
            fetch('projects.json')
                .then(response => {
                    if (!response.ok) { throw new Error("Network response was not ok"); }
                    return response.json();
                })
                .then(data => {
                    projects = data;
                    allProjectsFlattened = flattenProjects(projects);
                    updateAllProjectIds();
                    
                    setupEventListeners();
                    setLanguage(currentLang, true); // true for initial load
                })
                .catch(error => console.error('Errore nel caricamento dei progetti:', error));
        });

        function setupEventListeners() {
            setupMobileMenu();

            // Toggle Tema
            document.getElementById('themeToggle').addEventListener('click', (e) => {
                e.preventDefault();
                const newTheme = document.body.classList.toggle('dark-theme') ? 'dark' : 'light';
                localStorage.setItem('theme', newTheme);
            });

            // Selettore Lingua
            document.querySelectorAll('.language-selector-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    setLanguage(this.dataset.lang);
                });
            });

            // Eventi Keyboard per Modal
            document.addEventListener('keydown', function(e) {
                const imageModal = document.getElementById('imageModal');
                if (imageModal.style.display !== 'flex') return;
                if (e.key === 'Escape') closeImageModal();
                if (e.key === 'ArrowLeft') showPrevImage(e);
                if (e.key === 'ArrowRight') showNextImage(e);
            });

            // Eventi Touch per Modal (Swipe)
            const imageModal = document.getElementById('imageModal');
            let touchStartX = 0;
            let touchEndX = 0;

            imageModal.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
            });

            imageModal.addEventListener('touchmove', (e) => {
                touchEndX = e.touches[0].clientX;
            });

            imageModal.addEventListener('touchend', () => {
                if (touchStartX - touchEndX > 50) { // Swipe left
                    showNextImage(event);
                }
                if (touchStartX - touchEndX < -50) { // Swipe right
                    showPrevImage(event);
                }
                touchStartX = 0;
                touchEndX = 0;
            });
        }

        function setLanguage(lang, isInitialLoad = false) {
            currentLang = lang;
            localStorage.setItem('lang', lang);

            // Applica traduzioni
            document.querySelectorAll('[data-lang-key]').forEach(element => {
                const key = element.dataset.langKey;
                if (translations[lang]?.[key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // Aggiorna selettore lingua attivo
            document.querySelectorAll('.language-selector-item').forEach(item => {
                item.classList.toggle('active', item.dataset.lang === lang);
            });

            // Se è il caricamento iniziale, mostra la home
            if (isInitialLoad) {
                const savedTheme = localStorage.getItem('theme') || 'light';
                if (savedTheme === 'dark') document.body.classList.add('dark-theme');
                showHome();
            } else {
                // Altrimenti, ricarica la vista corrente per aggiornare i testi
                switch (currentView) {
                    case 'home': showHome(); break;
                    case 'projects': showProjectsSection(false); break; // false = non scrollare
                    case 'projectDetail':
                        const projectId = document.getElementById('singleProjectDetail').dataset.projectId;
                        if (projectId) showProject(parseInt(projectId), false);
                        break;
                    case 'about': showAbout(false); break;
                    case 'contact': showContact(false); break;
                }
            }
        }

        // --- Logica di Navigazione e Visualizzazione Sezioni ---

        function showSection(sectionId, shouldScroll = true) {
            ['hero', 'homeProjects', 'projectsSection', 'aboutSection', 'contactSection'].forEach(id => {
                document.getElementById(id).style.display = 'none';
            });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                if (shouldScroll) {
                    requestAnimationFrame(() => {
                        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    });
                }
            }
        }

        function showHome() {
            currentView = 'home';
            showSection('hero', false); // Non scrollare all'hero
            document.getElementById('homeProjects').style.display = 'block';
            document.getElementById('singleProjectDetail').style.display = 'none';
            generateHomeProjects();
        }
        
        function showProjectsSection(shouldScroll = true) {
            currentView = 'projects';
            showSection('projectsSection', shouldScroll);
            document.getElementById('singleProjectDetail').style.display = 'none';
            document.getElementById('projectFilters').style.display = 'block';
            document.getElementById('projectsGrid').style.display = 'block';

            const projectsSection = document.getElementById('projectsSection');
            if (!projectsSection.querySelector('.section-title')) {
                const sectionTitleElement = document.createElement('h2');
                sectionTitleElement.className = 'section-title';
                sectionTitleElement.setAttribute('data-lang-key', 'portfolioTitle');
                sectionTitleElement.textContent = translations[currentLang].portfolioTitle;
                projectsSection.prepend(sectionTitleElement);
            }
            
            generateFilters();
            filterProjects(lastActiveFilter);
        }

        function showAbout(shouldScroll = true) {
            currentView = 'about';
            showSection('aboutSection', shouldScroll);
        }

        function showContact(shouldScroll = true) {
            currentView = 'contact';
            showSection('contactSection', shouldScroll);
        }
        
        function showProject(projectId, shouldScroll = true) {
            const project = findProjectById(projectId);
            if (!project) return;

            currentView = 'projectDetail';
            showSection('projectsSection', shouldScroll);
            document.getElementById('projectFilters').style.display = 'none';
            document.getElementById('projectsGrid').style.display = 'none';

            // Nascondi il titolo "Progetti" quando si visualizza il dettaglio del progetto
            const projectsSection = document.getElementById('projectsSection');
            const sectionTitleElement = projectsSection.querySelector('.section-title');
            if (sectionTitleElement) {
                sectionTitleElement.style.display = 'none';
            }

            const detailContainer = document.getElementById('singleProjectDetail');
            detailContainer.style.display = 'block';
            detailContainer.dataset.projectId = projectId;

            const backButtonHtml = `<button class="back-to-projects-btn" onclick="goBackToProjects()">${translations[currentLang].backToProjects}</button>`;
            const galleryHtml = project.images.map(image => `
                <div class="gallery-item">
                    <img src="${image.src}" alt="${image.description}" onclick="openImageModal(${project.id}, '${image.src}')" loading="lazy">
                    <p class="gallery-description">${image.description || ''}</p>
                </div>
            `).join('');

            detailContainer.innerHTML = `
                ${backButtonHtml}
                <h2 class="project-detail-title">${project.title}</h2>
                <p class="project-detail-category">${getProjectCategoryLabel(project)}</p>
                <p class="project-detail-description">${project.description}</p>
                <div class="project-gallery">${galleryHtml}</div>
            `;
            
            if (shouldScroll) {
                setTimeout(() => {
                    detailContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
        }
        
        function goBackToProjects() {
            showProjectsSection();
        }

        // --- Logica di Gestione Progetti e Filtri ---

        function flattenProjects(node, path = '', projects = []) {
            for (const key in node) {
                if (Object.prototype.hasOwnProperty.call(node, key)) {
                    const childNode = node[key];
                    const currentPath = path ? `${path}.${key}` : key;
                    if (typeof childNode === 'object' && childNode !== null) {
                        if (Array.isArray(childNode.images)) {
                            projects.push({ ...childNode, categoryPath: currentPath });
                        } else {
                            flattenProjects(childNode, currentPath, projects);
                        }
                    }
                }
            }
            return projects;
        }

        function updateAllProjectIds() {
            allProjectsFlattened.forEach((p, index) => p.id = index + 1);
        }

        function findProjectById(id) {
            return allProjectsFlattened.find(p => p.id === id);
        }

        function getProjectCategoryLabel(project) {
            if (!project?.categoryPath) return translations[currentLang].unknownCategory;
            const pathParts = project.categoryPath.split('.').slice(0, -1);
            return pathParts.map(part => translations[currentLang][`category_${part}`] || formatFolderNameForDisplay(part)).join(' ') || translations[currentLang].unknownCategory;
        }
        
        function generateHomeProjects() {
            const grid = document.getElementById('homeProjectsGrid');
            if (!grid) return;
            grid.innerHTML = allProjectsFlattened.map(project => `
                <div class="project-card fade-in" onclick="showProject(${project.id})">
                <img src="${project.images[0].src}" alt="${project.title}" loading="lazy">
                <div class="project-overlay">${project.description || ''}</div>
                </div>
            `).join('');
            distributeMasonry(grid);
        }

        function filterProjects(filter) {
            lastActiveFilter = filter;
            const projectsGrid = document.getElementById('projectsGrid');

            const filteredProjects = (filter === 'all')
                ? allProjectsFlattened
                : allProjectsFlattened.filter(p => p.categoryPath.startsWith(filter));

            // Creiamo i progetti come stringa
            const cardsHTML = filteredProjects.map(project => `
                <div class="project-card fade-in" onclick="showProject(${project.id})">
                <img src="${project.images[0].src}" alt="${project.title}" loading="lazy">
                <div class="project-overlay">${project.description || ''}</div>
                </div>
            `).join('');

            // Inseriamo tutte le card temporaneamente
            projectsGrid.innerHTML = cardsHTML;

            // Distribuiamo le card in colonne
            distributeMasonry(projectsGrid);

            // Aggiorniamo lo stato dei bottoni
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
        }


        // Aggiungiamo lo stesso comportamento per le anteprime nella sezione "Progetti"
        document.addEventListener('DOMContentLoaded', () => {
            const projectsGrid = document.getElementById('projectsGrid');
            projectsGrid.addEventListener('mouseover', e => {
                if (e.target.closest('.project-card')) {
                e.target.closest('.project-card').querySelector('.project-overlay').style.opacity = '1';
                }
            });
            projectsGrid.addEventListener('mouseout', e => {
                if (e.target.closest('.project-card')) {
                e.target.closest('.project-card').querySelector('.project-overlay').style.opacity = '0';
                }
            });
        });
        
        // MODIFICATO: Logica di generazione filtri per escludere i progetti "foglia"
        function collectCategoryPaths(node, path, pathsSet) {
            for (const key in node) {
                if (Object.prototype.hasOwnProperty.call(node, key)) {
                    const childNode = node[key];
                    // Un nodo è una "categoria" se è un oggetto e NON ha una proprietà "images".
                    // La proprietà "images" identifica un nodo come un progetto finale (foglia).
                    if (typeof childNode === 'object' && childNode !== null && !Array.isArray(childNode.images)) {
                        const currentPath = path ? `${path}.${key}` : key;
                        pathsSet.add(currentPath);
                        // Continua la ricorsione all'interno di questa categoria.
                        collectCategoryPaths(childNode, currentPath, pathsSet);
                    }
                }
            }
        }

        function generateFilters() {
            const filtersContainer = document.getElementById('projectFilters');
            const categoryPaths = new Set();
            collectCategoryPaths(projects, '', categoryPaths);

            let filtersHtml = `<button class="filter-btn" data-filter="all" onclick="filterProjects('all')">${translations[currentLang].filterAll}</button>`;
            
            const sortedCategories = Array.from(categoryPaths).sort((a, b) => a.localeCompare(b));

            sortedCategories.forEach(path => {
                const label = path.split('.').map(part => translations[currentLang][`category_${part}`] || formatFolderNameForDisplay(part)).join(' ');
                filtersHtml += `<button class="filter-btn" data-filter="${path}" onclick="filterProjects('${path}')">${label}</button>`;
            });
            filtersContainer.innerHTML = filtersHtml;
        }



        // --- Funzioni di Utilità e UI ---

        function formatFolderNameForDisplay(name) {
            return name.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        function setupMobileMenu() {
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navMenu.classList.toggle('active');
            });
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    navMenu.classList.remove('active');
                });
            });
        }

        // Modal Immagini
        function openImageModal(projectId, imageSrc) {
            const project = findProjectById(projectId);
            if (!project) return;

            currentProjectImages = project.images;
            currentImageIndex = currentProjectImages.findIndex(img => img.src === imageSrc);
            
            const modal = document.getElementById('imageModal');
            document.getElementById('modalImage').src = imageSrc;
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal(event) {
            if (event && event.target.id === 'modalImage') return;
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = '';
        }

        function showNextImage(event) {
            event.stopPropagation();
            currentImageIndex = (currentImageIndex + 1) % currentProjectImages.length;
            document.getElementById('modalImage').src = currentProjectImages[currentImageIndex].src;
        }

        function showPrevImage(event) {
            event.stopPropagation();
            currentImageIndex = (currentImageIndex - 1 + currentProjectImages.length) % currentProjectImages.length;
            document.getElementById('modalImage').src = currentProjectImages[currentImageIndex].src;
        }

        function distributeMasonry(grid) {
            const cards = Array.from(grid.querySelectorAll('.project-card'));
            if (cards.length === 0) return;

            // Svuoto la griglia
            grid.innerHTML = '';

            // Creo 3 colonne
            const columns = [[], [], []];
            cards.forEach((card, i) => {
                columns[i % 3].push(card);
            });

            // Popolo le colonne e le aggiungo al container
            columns.forEach(colCards => {
                const colDiv = document.createElement('div');
                colDiv.className = 'projects-column';
                colCards.forEach(card => colDiv.appendChild(card));
                grid.appendChild(colDiv);
            });
        }

        // Header e Footer allo scroll
        window.addEventListener('scroll', function() {
            const isScrolled = window.pageYOffset > 50;
            document.querySelector('header').classList.toggle('scrolled', isScrolled);
            document.querySelector('footer').classList.toggle('scrolled', isScrolled);
        });
    </script>
</body>
</html>
